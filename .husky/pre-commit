#!/usr/bin/env sh

echo "ğŸ§ª ã‚³ãƒŸãƒƒãƒˆå‰ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™..."

# lint-stagedã‚’å®Ÿè¡Œ
npx lint-staged

echo "ğŸ” HTMLæ¤œè¨¼ã‚’å®Ÿè¡Œ..."
npx html-validate index.html
if [ $? -ne 0 ]; then
  echo "âŒ HTMLæ¤œè¨¼ãŒå¤±æ•—ã—ã¾ã—ãŸ"
  exit 1
fi

# ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
echo "ğŸ“‹ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ..."
npm run test:content
if [ $? -ne 0 ]; then
  echo "âŒ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ"
  exit 1
fi

echo "ğŸ“ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ..."
npm run test:layout
if [ $? -ne 0 ]; then
  echo "âŒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ"
  exit 1
fi

echo "ğŸ§ª ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ..."
npm test -- --reporter=verbose
if [ $? -ne 0 ]; then
  echo "âŒ ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ"
  exit 1
fi

echo "âœ… ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒåˆæ ¼ã—ã¾ã—ãŸï¼"
